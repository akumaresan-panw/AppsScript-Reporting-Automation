<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slide Deck Automation Guide</title>
    <style>
        /* General Styling */
        :root {
            --primary-color: #4285F4; /* Google Blue */
            --secondary-color: #34A853; /* Google Green */
            --background-color: #f8f9fa;
            --text-color: #3c4043;
            --header-color: #202124;
            --card-bg: #ffffff;
            --border-color: #dfe1e5;
            --code-bg: #202124;
            --code-text: #e8eaed;
        }
        body {
            font-family: 'Roboto', Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            background-color: var(--background-color);
            color: var(--text-color);
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: var(--header-color);
            font-weight: 500;
        }
        h1 {
            font-size: 2.5em;
            text-align: center;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h2 {
            font-size: 2em;
            color: var(--primary-color);
            margin-top: 40px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 5px;
        }
        h3 {
            font-size: 1.4em;
            color: var(--secondary-color);
        }
        p, li {
            font-size: 1.1em;
        }
        a {
            color: var(--primary-color);
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }

        /* Card and Section Styling */
        section {
            background-color: var(--card-bg);
            margin-top: 25px;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(60,64,67,0.15);
        }
        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            margin-top: 15px;
        }
        
        /* Code Block Styling */
        pre {
            background-color: var(--code-bg);
            color: var(--code-text);
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Fira Code', 'Courier New', monospace;
            position: relative;
        }
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #5f6368;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        pre:hover .copy-btn {
            opacity: 1;
        }
        code {
            background-color: #e8eaed;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: 'Fira Code', 'Courier New', monospace;
        }

        /* List Styling */
        ul {
            list-style-type: none;
            padding-left: 0;
        }
        ul li {
            padding-left: 25px;
            position: relative;
            margin-bottom: 10px;
        }
        ul li::before {
            content: '‚úîÔ∏è';
            color: var(--secondary-color);
            position: absolute;
            left: 0;
        }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>üìä Slide Deck Automation Guide</h1>
            <p style="text-align: center; font-size: 1.2em;">Learn how to automate recurring business reports using Google Workspace and Gemini.</p>
        </header>

        <section id="introduction">
            <h2>Introduction: How It Works</h2>
            <p>This guide outlines a workflow to automate the creation of Google Slides presentations for recurring reports (like Quarterly Business Reviews). By connecting data from Google Sheets to Google Slides via a custom Google Apps Script, you can automatically populate text-based commentary. [cite_start]The script itself is generated by Gemini based on your specific needs. [cite: 35, 47, 48]</p>
            <h3>The Relationship Between Each Tool:</h3>
            <p><b>Google Sheets:</b> Acts as the database. [cite_start]All your data and metrics are stored and organized here. [cite: 40] [cite_start]For dynamic data, you can use functions like <code>=IMPORTRANGE</code> to pull from other sources automatically. [cite: 108]</p>
            <p><b>Gemini:</b> The code generator. [cite_start]You provide it with structured prompts and templates, and it writes the Apps Script code for you, requiring no technical experience. [cite: 37]</p>
            <p><b>Google Apps Script:</b> The engine that connects everything. [cite_start]It's a cloud-based JavaScript platform that runs in the background of Google Workspace apps. [cite: 45] This script will read data from your Sheet and use it to populate placeholders in your Slides presentation.</p>
            [cite_start]<p><b>Google Slides:</b> The final output where your automated presentation is generated. [cite: 43]</p>
        </section>

        <section id="setup">
            <h2>Setup Guide: Step-by-Step</h2>

            <h3>Step 1: Identify Commentary and Create Placeholders</h3>
            [cite_start]<p>First, identify the text on your slides that changes each reporting period but follows a consistent structure. [cite: 54, 55] [cite_start]Convert these dynamic parts into simple, descriptive placeholders. [cite: 59]</p>
            [cite_start]<p><b>Keys to good placeholders:</b> [cite: 65]</p>
            <ul>
                <li>Be specific in your naming. [cite_start]Instead of a generic <code>[percent]</code>, use something descriptive like <code>[percent_of_Y/Y_total_deals_that_slipped]</code>. [cite: 67]</li>
                [cite_start]<li>Instead of <code>[value]</code>, try <code>[largest_number_of_new_hires_by_function]</code>. [cite: 68]</li>
            </ul>
            <h4>Example Transformation:</h4>
            [cite_start]<p><b>Original Text:</b> [cite: 61]</p>
            <blockquote>Among the top 10 EAs closed in Q3‚Äô25 M1+M2:  ____% ($____M) of the top 10 EA Deals were from Strategic (___% in PY), followed by Majors ___% ($___M) vs. ___% in PY</blockquote>
            [cite_start]<p><b>Becomes Placeholder Text:</b> [cite: 64]</p>
            <blockquote>Among the top 10 EAs closed in [Quarter] M1+M2:
[percent of sector of top 10 ea deals]% ($[dollar value of portion of top 10 ea deals]) of the top 10 EA Deals were from [sector] ([percent of prev year]% in PY), followed by [percent of sector of top 10 ea deals]% ($[dollar value of portion of top 10 ea deals]) vs. [percent of prev year]% in PY</blockquote>
            [cite_start]<p>Your slides template should contain a unique placeholder shape for each commentary block you want to automate, like <code>[TOP_10_EA_DEALS_PLACEHOLDER]</code>. [cite: 3]</p>


            <h3>Step 2: Prepare Your Google Sheet</h3>
            [cite_start]<p>Set up a Google Sheet to be your data source. [cite: 40] [cite_start]To keep your data live and referential, use the <code>=IMPORTRANGE</code> function to pull data directly from other spreadsheets, like a master data source from BigQuery. [cite: 108] This ensures your data is always up-to-date without manual intervention.</p>
            <p><b>Formula Example:</b></p>
            <pre><code>=IMPORTRANGE("https://docs.google.com/spreadsheets/d/your_spreadsheet_id", "SheetName!A1:D10")</code><button class="copy-btn">Copy</button></pre>
            [cite_start]<p><b>Note:</b> When defining the range, always include the sheet name followed by an exclamation mark (e.g., <code>"Revenue 2025!A10:Q53"</code>). [cite: 110, 112]</p>

            <h3>Step 3: Generate the Apps Script with Gemini</h3>
            <p>This is the core of the automation. [cite_start]You will prompt Gemini to generate the Apps Script code that connects your Sheet and Slides. [cite: 48, 69] [cite_start]Providing a clear, structured prompt is crucial for getting the best results. [cite: 38]</p>
            
            <h4>How to Structure Your Prompt:</h4>
            <p>Use the following template to build your request for Gemini. [cite_start]Provide global information and then define each commentary block you want to automate. [cite: 75, 76]</p>
            <pre><code>Hello Gemini. Please generate the complete Google Apps Script code for my automated reporting pipeline.

### Global Information:
- [cite_start]**Spreadsheet ID:** "1aBcDeF...xyz" (Found in the Google Sheet URL) [cite: 78]
- [cite_start]**Sheet Name for Data:** "QBR Data" (The exact name of the tab in your sheet) [cite: 79]

### Commentary Block 1:
- [cite_start]**Commentary Name:** NAM OPEX and HC [cite: 81]
- [cite_start]**Slides Placeholder:** [NAM_OPEX_HC_PLACEHOLDER] [cite: 82]
- [cite_start]**Sheet Output Cell:** C41 (Where the final text will be written in Sheets) [cite: 83]
- [cite_start]**Data Mapping:** [cite: 84]
  - [cite_start]opexAmount: G41, "Total OPEX for the quarter" [cite: 85]
  - [cite_start]headcount: G42, "Current headcount" [cite: 86]
- [cite_start]**Output Text Template:** "North America OPEX for the quarter was opexAmount with a headcount of headcount." [cite: 87]

### Commentary Block 2:
- [cite_start]**Commentary Name:** Trending Discount [cite: 91]
- [cite_start]**Slides Placeholder:** [TRENDING_DISCOUNT_PLACEHOLDER] [cite: 92]
- [cite_start]**Sheet Output Cell:** C31 [cite: 93]
- [cite_start]**Data Mapping:** [cite: 94]
  - [cite_start]avgDiscount: G31, "The average discount rate" [cite: 94]
- [cite_start]**Output Text Template:** "The average discount rate for the quarter was avgDiscount." [cite: 95]

[cite_start](Add as many commentary blocks as you need for your slides.) [cite: 98]

Please create a custom menu in Google Slides to run this automation.
</code><button class="copy-btn">Copy</button></pre>

            <h3>Step 4: Deploy and Authorize the Script</h3>
            <p>Once Gemini provides the code:</p>
            <ol>
                <li>Open your Google Slides presentation.</li>
                <li>Go to <b>Extensions > Apps Script</b>. [cite_start]This will open the script editor. [cite: 45]</li>
                <li>Paste the code generated by Gemini into the editor, replacing any default code.</li>
                <li>Save the project. You will be prompted to authorize the script. [cite_start]This is a necessary step to allow the script to access your Sheets and Slides data. [cite: 46]</li>
                <li>Click "Review permissions" and "Allow" to grant the necessary access.</li>
                <li>Refresh your Google Slides document. A new custom menu item (e.g., "Reporting Automation") should appear. Use this menu to run your script and populate the slides.</li>
            </ol>
            <img src="https://storage.googleapis.com/path-to-your-image/apps-script-menu.png" alt="Apps Script menu location">
            [cite_start]<p style="text-align:center; font-style:italic;">Location of the Apps Script editor in the Extensions menu. [cite: 45]</p>
            <img src="https://storage.googleapis.com/path-to-your-image/authorization-required.png" alt="Authorization required dialog box">
            <img src="https://storage.googleapis.com/path-to-your-image/untitled-project-access.png" alt="Granting project access to Google Account">
            [cite_start]<p style="text-align:center; font-style:italic;">Always authorize the script to allow it to connect to your files. [cite: 46]</p>

        </section>

        <section id="best-practices">
            <h2>‚≠ê Best Practices & Advice</h2>
            <ul>
                <li><b>Start Small:</b> Begin by automating just one or two commentary blocks. Once you've confirmed the process works, expand it to other slides.</li>
                <li><b>Keep Data Clean:</b> Ensure the data in your Google Sheet is well-organized. A clean data source prevents most common errors.</li>
                <li><b>Import Only What's Needed:</b> To keep the script fast and efficient, only import the essential data points into your target sheet. [cite_start]Too much data can slow down runtime. [cite: 114, 115]</li>
                <li><b>Use a "Config" Tab:</b> For larger projects, consider creating a separate "Config" tab in your Google Sheet. Store important information like Spreadsheet IDs, sheet names, and placeholder names there. This makes your script more modular and easier to update without digging into the code.</li>
                <li><b>Add Error Handling:</b> For more robust scripts, ask Gemini to include `try...catch` blocks in the code. This will help you gracefully handle errors (e.g., if a data cell is empty) and make debugging easier.</li>
                <li><b>Version Your Code:</b> Use the versioning feature in the Apps Script editor (File > Manage versions) to save working copies of your code. This allows you to revert to a previous state if an update causes issues.</li>
            </ul>
        </section>

        <section id="faq">
            <h2>Frequently Asked Questions (FAQ)</h2>
            <h3>What is Google Apps Script?</h3>
            <p>Google Apps Script is a rapid application development platform that makes it fast and easy to create business applications that integrate with Google Workspace. [cite_start]It's based on JavaScript and lives in the cloud, so there's nothing to install. [cite: 45]</p>

            <h3>What if my data in Google Sheets changes location (e.g., a different cell)?</h3>
            <p>You will need to update the data mapping in your Gemini prompt (e.g., change `G41` to the new cell) and regenerate the relevant part of the script. This is why having a well-structured and stable data sheet is important.</p>

            <h3>How do I debug my script if it's not working?</h3>
            <p>The best way to debug is to use `Logger.log()`. You can add `Logger.log(variableName);` at various points in your script to print the value of variables. After running the script, go to the Apps Script editor and click on "Executions" to view the logs and see what's happening.</p>
            
            <h3>Can this automation process work for Google Docs or other Google apps?</h3>
            <p>Yes, absolutely. The core principles are the same. You would simply use a different service in Apps Script (e.g., `DocumentApp` for Google Docs or `GmailApp` for Gmail) and adjust your prompt to Gemini accordingly.</p>
            
            <h3>Are there any limitations I should be aware of?</h3>
            <p>Yes, Google Apps Script has certain quotas and limitations, such as a maximum script runtime of 6 minutes for consumer accounts. [cite_start]For most reporting automation, this is more than enough time, but it's a factor to consider for extremely large or complex tasks. [cite: 115]</p>
        </section>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const pre = e.target.closest('pre');
                    const code = pre.querySelector('code').innerText;
                    navigator.clipboard.writeText(code).then(() => {
                        button.innerText = 'Copied!';
                        setTimeout(() => {
                            button.innerText = 'Copy';
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy text: ', err);
                    });
                });
            });
        });
    </script>

</body>
</html>
